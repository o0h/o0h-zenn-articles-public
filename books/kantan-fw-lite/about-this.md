---
title: "この本のねらい・作るものについて"
---

## 何を作っていくか

まずは静的なコンテンツを表示するところから始め、「機能を追加する」「そのために既存の仕組みをリファクタ/リライトする」という段階を踏まえながら、最終的にごく簡単なフレームワークの完成させていきます。
読者の皆様は、比較的短いサイクルで「実際にブラウザ上で動かせる」というフィードバックを得ながら、作業を進めていくことになるでしょう。

このBookは、(経験者のナビゲートを込みで)全体を60分弱ほどで完了できるボリュームを想定しています。
そのため、「動くコードを書き切る」ことにフォーカスを絞り、間接的な要素は大胆に割愛していきます。

:::message
例えば、「本来的にはありえない」と考えますが、テストコードの作成については泣く泣く解説を諦めることになります。
:::

作成するアプリケーションの内容としては、「キリ番掲示板」です。
キリ番掲示板についてご存知ない方は、下記のリンクなどを参照してください。

https://www.itmedia.co.jp/pcuser/articles/1612/08/news014.html

### 学べること

:::message
「60分程度で」というコンセプトの都合上、実装上で現れる各概念についての解説は最低限に留めます。
必要に応じて、自身での学習を進めてください
:::

一連のチュートリアルを通して、以下の概念と実装について触れることが出来ます。

- MVC2ライクのフレームワークの作成と動作
  - ルーティング、アクションディスパッチ、プレゼンテーション分離といった要素を含みます
- Composerによるプロジェクトの作成・管理
- Dependency Injectionの利用・DIコンテナ / [PSR\-11: Container interface](https://www.php-fig.org/psr/psr-11/)
- 現代的なPHPにおけるリクエスト・レスポンスの表現 / [PSR\-7: HTTP message interfaces](https://www.php-fig.org/psr/psr-7/)
  - および、その生成 / [PSR\-17: HTTP Factories](https://www.php-fig.org/psr/psr-17/)
- ミドルウェアパターン / [PSR\-15: HTTP Server Request Handlers](https://www.php-fig.org/psr/psr-15/)

## 本題の前に: フレームワークって何？

フレームワークを日本語に訳すと「枠組み」「構造」といった訳語があてられます。
Webアプリケーションフレームワークは、Webアプリケーションを動かすための基礎となる土台です。

では、「普通の」アプリケーションとフレームワークを利用したアプリケーションでは、何が違うのでしょうか？
筆者はMartin Fowler氏の言う「InversionOfControl(IoC)」の存在に着目しており、IoCの活用を前提とした「アプリケーション開発者が作成したロジックを、実行・制御するための基礎となる仕組みを提供するもの」がフレームワークだと考えています。

https://bliki-ja.github.io/InversionOfControl

制御の逆転とは、ごく簡単に言えば「処理の起点を自ら作る」のではなく「必要な処理を作成して、それが”誰か”に呼び出されるようにする」というものです。
フレームワークが、この”誰か”に相当します。

例えば、「 _http://localhost/user-register.php_ を呼び出したら、`user-register`プログラムが呼び出される」といったやり方は、逆転を伴わずに制御が実行される形式といえます。HTTPサーバーの設定(mod_rewriteなど)によって、拡張子の省略やURI上のパスを区切るといった変形を加えたとしても、「リクエストを受けるプログラム」が変わっている場合には、状況は変わりません。

![](/./images/books/kantan-fw-lite/about-this/1.png)
_「普通の」アプリケーションの作り方だと、プログラムが直接起動される_

一方で、フレームワークを用いた開発においては、いかなるパスであっても(該当するスクリプトファイルが設置されていなければ) フロントコントローラー = *index.php*に処理が寄せられる、というのが一般的な作りと言えます。そして、_index.php_ はフレームワークの処理を起動します。
これは、「開発者が作ったアプリケーション機能」を「直接呼び出されずに、フレームワーク経由で間接的に呼び出されるようにしている」と言えます。すなわち、「起動したい処理(アプリケーション機能)」が全体処理の制御をしているのではなく、「制御される側」になっているのです。
それゆえに、制御の逆転が発生していると言われます。

![](/./images/books/kantan-fw-lite/about-this/2.png)
_フレームワークが一手にリクエストを受け止め、ロジックに従って適切な機能を呼び出す_

フレームワークは、「リクエストされた内容(URI等)やコンテキスト(セッション等)から、どの機能を呼び出すか」を判断する機能を提供しています。
そのために、ある程度の一般化された呼び出し方・使い方に従うことが、開発者に要請されることが多いです。例えば、「コントローラーは特定のクラスを継承しなければいけない」とか「クラスについての命名規則が定められている」といった決まり事は、その一環と言えるでしょう。  
そうすることで、利用についての手続きの一般化が進み、正に「枠組み」と呼ぶに相応しい能力を得ることになります。[^coc]

[^coc]: もちろん、フレームワーク自体がアプリケーション開発者に要請する決まり事が非常に緩やかな例もあります(例: Slim)。その場合には、開発者はフレームワークに対して、設定として自らのルールを注入することになります。決まりごとの拡大・一般化の進展によって「仕事を省略しやすくなる」という利点が損なわれる一方で、開発者は非常に柔軟な管理方法を手に入れることができます。
